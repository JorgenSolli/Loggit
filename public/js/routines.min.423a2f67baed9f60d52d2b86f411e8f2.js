var initSort=function(){$("#sortable").sortable({containment:"document",items:"> div",handle:".handle",tolerance:"pointer",cursor:"move",opacity:.8,revert:300,delay:150,placeholder:"movable-placeholder",start:function(e,s){s.placeholder.height(s.helper.outerHeight())}}),$(".sortable-content-children").sortable({items:"> div",tolerance:"pointer",containment:"parent"})},initDrag=function(){$(".sortable-content-children").sortable({items:"> div",tolerance:"pointer",containment:"parent"})};$(document).on("click",".viewRoutine",function(){var e=$(this).children("input").val();$("#routines").hide(),$("#viewRoutine").html('<div id="pageload"><div class="showbox"><div class="loader"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg></div><p class="loader-text">Getting routine...</p></div></div>').show(),$.ajax({url:"/dashboard/my_routines/view/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",success:function(e){$("#viewRoutine").html(e.data).show(),$("#sortable").sortable({handle:".handle",cursor:"move",cancel:""}).disableSelection(),$(".selectpicker").selectpicker({}),initSort()},error:function(){$("#viewRoutine").hide(),$("#routines").show()}})}),$(document).on("click",".routine-back",function(){$("#viewRoutine").empty().hide(),$("#routines").show(),$(".ps-container").scrollTop(0),$(".ps-container").perfectScrollbar("update")}),$(document).on("click",".deleteRoutine",function(){var e=$(this).attr("id"),s=$("#routine-"+e).find(".routine-name").html().trim();swal({title:"Are you sure?",text:s+" will be gone forever and all connected workouts will be lost. Please consider marking the routine as inactive instead!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){swal("Deleted!","Your routine has been deleted.","success"),deleteRoutine(e)})});var deleteRoutine=function(e){$.ajax({url:"/dashboard/my_routines/delete/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",success:function(s){$("#routine-"+e).fadeOut(),$("tr.child").fadeOut()}})};$(document).on("click","#addMore",function(){var e=parseInt($("#exerciseNr").val()),s=e+1,t='<div class="thisExercise"><input class="exerciseOrder" type="hidden" name="exercises['+s+'][order_nr]" value=""><div class="card m-t-10 m-b-10"><div class="card-content"><div class="sortable-content"><div class="sort-icon handle clearfix">Drag me to sort <span class="fa fa-arrows-v"></span><a class="deleteExercise btn btn-sm btn-danger pull-right"><span class="fa fa-trash"></span></a></div><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group m-t-10 label-floating"><label class="control-label" for="exercise_name">Excersice name</label><input type="text" class="required form-control exercise_name" id="exercise_name" name="exercises['+s+'][exercise_name]"></div></div><div class="col-xs-12 col-sm-6"><div class="form-group" style="margin-top: 4px;"><select id="muscle_group" class="selectpicker" name="exercises['+s+'][muscle_group]" data-style="select-with-transition" title="Choose a muscle group" data-size="8"><option selected disabled>Select a muscle group</option><option value="back">Back</option><option value="biceps">Biceps</option><option value="triceps">Triceps</option><option value="abs">Abs</option><option value="shoulders">Shoulders</option><option value="legs">Legs</option><option value="chest">Chest</option></select></div></div></div><div class="row"><div class="col-xs-12 col-sm-4"><div class="form-group m-t-10 label-floating"><label class="control-label" for="goal_weight">Weight goal</label><input type="number" step="any" class="required form-control" id="goal_weight" name="exercises['+s+'][goal_weight]"></div></div><div class="col-xs-6 col-sm-4"><div class="form-group m-t-10 label-floating"><label class="control-label" for="goal_sets">Sets goal</label><input type="number" class="required form-control" id="goal_sets" name="exercises['+s+'][goal_sets]"></div></div><div class="col-xs-6 col-sm-4"><div class="form-group m-t-10 label-floating"><label class="control-label" for="goal_reps">Reps goal</label><input type="number" class="required form-control" id="goal_reps" name="exercises['+s+'][goal_reps]"></div></div></div><div class="row"><div class="col-md-4"><div class="checkbox"><label><input type="checkbox" name="exercises['+s+'][is_warmup]"> Warmup set</label></div></div></div></div></div></div></div>';$("#exerciseNr").val(s),$("#sortable").append(t),$(".selectpicker").selectpicker({})}),$(document).on("click","#addSuperset",function(){var e=parseInt($("#supersetNr").val()),s=e+1,t='<div class="thisExercise"><input class="exerciseOrder" type="hidden" name="supersets['+s+'][order_nr]" value=""><div class="card card-transparent m-t-10 m-b-10"><div class="card-content"><div class="sortable-content"><div class="sort-icon handle"> Drag me to sort <span class="fa fa-arrows-v"></span><a class="deleteExercise btn btn-sm btn-danger pull-right"><span class="fa fa-trash"></span></a></div><div class="form-group label-floating"><label class="control-label" for="exercise_name">Superset Name</label><input type="text" class="required form-control exercise_name" id="exercise_name" name="supersets['+s+'][superset_name]"></div></div><div class="sortable-content-children"></div><input type="hidden" class="thisSupersetNr" value="'+s+'"><button id="addMore-superset" type="button" class="btn btn-primary">Add another exercise</button></div></div></div>';$("#supersetNr").val(s),$("#sortable").append(t),$(".selectpicker").selectpicker({}),initSort()}),$(document).on("click","#addMore-superset",function(){var e=parseInt($(this).parent().find(".thisSupersetNr").val()),s=e,t=parseInt($("#exerciseNr").val()),a=t+1,l='<div class="thisExercise"><div class="card m-t-10 m-b-10"><div class="card-content"><div class="sortable-content"><div class="sort-icon handle-child">Drag me to sort <span class="fa fa-arrows-v"></span><a class="deleteExercise deleteExercise-supserset btn btn-sm btn-danger pull-right"><span class="fa fa-trash"></span></a></div><div class="form-group label-floating"><label class="control-label" for="exercise_name">Excersice name</label><input type="text" class="required form-control exercise_name" id="exercise_name" name="supersets['+s+"]["+a+'][exercise_name]"></div><div class="form-group" style="margin-top: 4px;"><select id="muscle_group" name="supersets['+s+"]["+a+'][muscle_group]" class="selectpicker" data-style="select-with-transition" title="Choose a muscle group" data-size="8"><option selected disabled>Select a muscle group</option><option value="back">Back</option><option value="biceps">Biceps</option><option value="triceps">Triceps</option><option value="abs">Abs</option><option value="shoulders">Shoulders</option><option value="legs">Legs</option><option value="chest">Chest</option></select></div><div class="row"><div class="col-md-4"><div class="form-group label-floating"><label class="control-label" for="goal_weight">Weight goal</label><input type="number" step="any" class="required form-control" id="goal_weight" name="supersets['+s+"]["+a+'][goal_weight]"></div></div><div class="col-md-4"><div class="form-group label-floating"><label class="control-label" for="goal_sets">Sets goal</label><input type="number" class="required form-control" id="goal_sets" name="supersets['+s+"]["+a+'][goal_sets]"></div></div><div class="col-md-4"><div class="form-group label-floating"><label class="control-label" for="goal_reps">Reps goal</label><input type="number" class="required form-control" id="goal_reps" name="supersets['+s+"]["+a+'][goal_reps]"></div></div></div><div class="row"><div class="col-md-4"><div class="checkbox"><label><input type="checkbox" name="supersets['+s+"]["+a+'][is_warmup]"> Warmup set</label></div></div></div></div></div></div></div>';$("#supersetNr").val(s),$("#exerciseNr").val(a),$(this).parent().find(".sortable-content-children").append(l),$(".selectpicker").selectpicker({}),initDrag()}),$(document).on("click",".deleteExercise",function(){$(this).closest(".thisExercise").fadeOut(function(){$(this).empty()})}),$(document).on("click","#addRoutine",function(){var e=!0;$(".required").each(function(){""==$(this).val()||null==$(this).val()?($(this).closest(".form-group").addClass("has-error").find(".control-label").removeClass("hidden"),e=!1):$(this).closest(".form-group").removeClass("has-error").find(".control-label").addClass("hidden")}),$(".btn-group.bootstrap-select").each(function(){"Select a muscle group"==$(this).find("button").attr("title")?($(this).closest(".form-group").addClass("has-error").find(".control-label").removeClass("hidden"),e=!1):$(this).closest(".form-group").removeClass("has-error").find(".control-label").addClass("hidden")});var s=[],t=[],a=!1;$(".exercise_name").each(function(){s.push($(this).val())}),s.sort();for(var l=0;l<s.length-1;l++)s[l+1]==s[l]&&(t.push(s[l]),a=!0,e=!1);return a?$("#alert-field").html('<div class="alert alert-danger"><strong>Whops!</strong> Some of your exercises shares the same name ('+t[0]+"). This might cause issues. Append something to your duplicate exercisenames and try again.</div>"):$("#alert-field").empty(),$(".exerciseOrder").each(function(e){$(this).val(e)}),e&&$(this).html('<span class="fa fa-spin fa-circle-o-notch"></span> Saving changes ...'),e}),$(document).on("click","#changeStatus",function(){var e=$("#routineId").val(),s=$("#status").val();$.ajax({url:"/dashboard/my_routines/edit/status/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",data:{routineId:e,status:s},success:function(e){console.log(e.success),e.success?location.reload():$("#changeStatus").removeClass("btn-default").addClass("btn-danger").text("Refresh page and try again!")},error:function(){$("#changeStatus").removeClass("btn-default").addClass("btn-danger").text("Refresh page and try again!")}})}),$(document).ready(function(){$("#datatables").DataTable({pagingType:"full_numbers",lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],responsive:!0,language:{search:"_INPUT_",searchPlaceholder:"Search records"}});$("#datatables").DataTable();initSort()});