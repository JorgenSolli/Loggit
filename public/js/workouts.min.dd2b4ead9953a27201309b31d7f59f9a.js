$(document).ready(function(){var e=function(e){$.ajax({url:"/api/delete_workout/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",success:function(t){console.log(t),t.success&&($("#workout-"+e).fadeOut(),$("tr.child").fadeOut())}})},t=function(e,t){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:e,method:"POST",data:t,success:function(e){e.success&&($.notify({icon:"add_alert",message:e.message},{type:"success",timer:2e3,placement:{from:"top",align:"right"}}),n())}})},n=function(){$("#data").empty(),$(".ps-container").scrollTop(0),$(".ps-container").perfectScrollbar("update"),$("#exercises").slideDown()};$("#exercises a").on("click",function(){var e=$(this),t=e.attr("id"),n=e.html();$(this).addClass("disabled"),$(this).html('<span class="fa fa-spin fa-circle-o-notch"></span> Getting exercise ...'),$.ajax({url:"/api/exercise/"+t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",success:function(t){$("#data").html(t.data),$("#exercises").slideUp(),$(".selectpicker").selectpicker({}),e.html(n).removeClass("disabled")}})}),$(document).on("change","#weight_type",function(){var e=$(this).val(),t=$(this).closest(".card-content").find(".weight_type");"band"==e?(t.find(".band").show().removeClass("ignore"),t.find(".raw").hide().addClass("ignore")):"assisted"==e?(t.find(".band").hide().addClass("ignore"),t.find(".raw").show().removeClass("ignore"),t.find(".raw_label").text("Assisted Weight")):(t.find(".band").hide().addClass("ignore"),t.find(".raw").show().removeClass("ignore"),t.find(".raw_label").text("Weight"))}),$(document).on("click","#finishWorkout",function(e){e.preventDefault();var t=!1,n=!1,o=0,s=$(this).attr("href");return $(".list-group-item").each(function(e){"incomplete"==$(this).attr("data-status")?(n=!0,o++):t=!0}),t?(n&&swal({title:"Sure you want to finish?",text:"You haven't completed all exercises!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, I'm done!",cancelButtonText:"No, I'll finish!",confirmButtonClass:"btn btn-danger",cancelButtonClass:"btn btn-success",buttonsStyling:!1}).then(function(){return window.location.href=s},function(e){if("cancel"===e)return void swal("Awesome!","Let's finish this!","success")}),t&&!n?($(this).addClass("disabled"),$(this).html('<span class="fa fa-spin fa-circle-o-notch"></span> finishing ...'),window.location.href=s):void 0):void swal({title:"Whops!",text:"You need to complete at least ONE exercies before finishing",type:"error",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"Understood!",confirmButtonClass:"btn btn-primary",buttonsStyling:!1})}),$(document).on("click","#cancelExercise",function(){n()}),$(document).on("click",".viewWorkout",function(){var e=$(this).children("input").val();$.ajax({url:"/api/get_workout/view/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",success:function(e){$("#workouts").hide(),$("#viewWorkout").html(e.data).show(),$(".selectpicker").selectpicker({})}})}),$(document).on("click",".deleteWorkout",function(){var t=$(this).attr("id"),n=$("#workout-"+t).find(".name").html().trim();swal({title:"Are you sure?",text:n+" will be gone forever!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){swal("Deleted!","The workout has been deleted.","success"),e(t)})}),$(document).on("click",".updateWorkoutRow",function(){var e=$("#workout_id").val(),t=$(this).parent().parent(),n=t.find(".reps").val(),o=t.find(".weight").val(),s=t.find(".selectpicker.weight_type").val(),a=t.find(".selectpicker.band_type").val(),i=t.find('input[name="workout_junction_id"]').val();$.ajax({url:"/api/update_workout/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",data:{junction_id:i,weight:o,weight_type:s,band_type:a,reps:n},success:function(e){e.success?$.notify({icon:"add_alert",message:"The exercise was successfully updated."},{type:"success",timer:2e3,placement:{from:"top",align:"right"}}):$.notify({icon:"add_alert",message:"Something went wrong. Try again or contact support."},{type:"danger",timer:3e3,placement:{from:"top",align:"right"}})}})}),$(document).on("click",".workout-back",function(){$("#viewWorkout").empty().hide(),$("#workouts").show(),$(".ps-container").scrollTop(0),$(".ps-container").perfectScrollbar("update")}),$(document).on("click","#saveWorkout",function(){var e=!0;if($(".required").each(function(t){""==$(this).val()&&$(this).parent().hasClass("ignore")===!1?($(this).closest(".form-group").addClass("has-error").find(".control-label").removeClass("hidden"),e=!1):$(this).closest(".form-group").removeClass("has-error").find(".control-label").addClass("hidden")}),e){$(this).addClass("disabled"),$(this).html('<span class="fa fa-spin fa-circle-o-notch"></span> saving ...');var n=$(this).closest("form").attr("action"),o=$(this).closest("form").serialize();t(n,o)}return e}),$(document).on("click","#clearSession",function(e){e.preventDefault(),swal({title:"Are you sure?",text:"All data connected to this session will be lost.",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, keep going!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",buttonsStyling:!1}).then(function(){window.location.href="/clear"},function(e){if("cancel"===e)return!1})}),$("#datatables").DataTable({pagingType:"full_numbers",lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],responsive:!0,order:[[0,"desc"]],language:{search:"_INPUT_",searchPlaceholder:"Search records"}})});